import math
from pulp import *
import pandas as pd
import numpy as np
import sys

data = pd.read_csv(sys.argv[1],comment='#')
index = data['Cell_Index'].values
convert = []
for i in range(len(index)):
    x = LpVariable("x", 1, 96, LpInteger)
    y = LpVariable("y", 1, 96, LpInteger)
    z = LpVariable("z", 1, 96, LpInteger)
    prob = LpProblem("problem", LpMinimize)
    prob += 96*96*(x-1) + 96*(y-1) + z == index[i]
    prob.solve()
    a = [math.trunc(value(x)),math.trunc(value(y)),math.trunc(value(z))]
    convert.append(a)
convert = np.array(convert)
bc1 = {1:'GTCGCTATA',2:'CTTGTACTA',3:'CTTCACATA',4:'ACACGCCGG',5:'CGGTCCAGG',6:'AATCGAATG',7:'CCTAGTATA',8:'ATTGGCTAA',9:'AAGACATGC',10:'AAGGCGATC',11:'GTGTCCTTA',12:'GGATTAGGA',13:'ATGGATCCA',14:'ACATAAGCG',15:'AACTGTATT',16:'ACCTTGCGG',17:'CAGGTGTAG',18:'AGGAGATTA',19:'GCGATTACA',20:'ACCGGATAG',21:'CCACTTGGA',22:'AGAGAAGTT',23:'TAAGTTCGA',24:'ACGGATATT',25:'TGGCTCAGA',26:'GAATCTGTA',27:'ACCAAGGAC',28:'AGTATCTGT',29:'CACACACTA',30:'ATTAAGTGC',31:'AAGTAACCC',32:'AAATCCTGT',33:'CACATTGCA',34:'GCACTGTCA',35:'ATACTTAGG',36:'GCAATCCGA',37:'ACGCAATCA',38:'GAGTATTAG',39:'GACGGATTA',40:'CAGCTGACA',41:'CAACATATT',42:'AACTTCTCC',43:'CTATGAAAT',44:'ATTATTACC',45:'TACCGAGCA',46:'TCTCTTCAA',47:'TAAGCGTTA',48:'GCCTTACAA',49:'AGCACACAG',50:'ACAGTTCCG',51:'AGTAAAGCC',52:'CAGTTTCAC',53:'CGTTACTAA',54:'TTGTTCCAA',55:'AGAAGCACT',56:'CAGCAAGAT',57:'CAAACCGCC',58:'CTAACTCGC',59:'AATATTGGG',60:'AGAACTTCC',61:'CAAAGGCAC',62:'AAGCTCAAC',63:'TCCAGTCGA',64:'AGCCATCAC',65:'AACGAGAAG',66:'CTACAGAAC',67:'AGAGCTATG',68:'GAGGATGGA',69:'TGTACCTTA',70:'ACACACAAA',71:'TCAGGAGGA',72:'GAGGTGCTA',73:'ACCCTGACC',74:'ACAAGGATC',75:'ATCCCGGAG',76:'TATGTGGCA',77:'GCTGCCAAT',78:'ATCAGAGCT',79:'TCGAAGTGA',80:'ATAGACGAG',81:'AGCCCAATC',82:'CAGAATCGT',83:'ATCTCCACA',84:'ACGAAAGGT',85:'TAGCTTGTA',86:'ACACGAGAT',87:'AACCGCCTC',88:'ATTTAGATG',89:'CAAGCAAGC',90:'CAAAGTGTG',91:'GGCAAGCAA',92:'GAGCCAATA',93:'ATGTAATGG',94:'CCTGAGCAA',95:'GAGTACATT',96:'TGCGATCTA'}
bc2 = {1:'TACAGGATA',2:'CACCAGGTA',3:'TGTGAAGAA',4:'GATTCATCA',5:'CACCCAAAG',6:'CACAAAGGC',7:'GTGTGTCGA',8:'CTAGGTCCT',9:'ACAGTGGTA',10:'TCGTTAGCA',11:'AGCGACACC',12:'AAGCTACTT',13:'TGTTCTCCA',14:'ACGCGAAGC',15:'CAGAAATCG',16:'ACCAAAATG',17:'AGTGTTGTC',18:'TAGGGATAC',19:'AGGGCTGGT',20:'TCATCCTAA',21:'AATCCTGAA',22:'ATCCTAGGA',23:'ACGACCACC',24:'TTCCATTGA',25:'TAGTCTTGA',26:'ACTGTTAGA',27:'ATTCATCGT',28:'ACTTCGAGC',29:'TTGCGTACA',30:'CAGTGCCCG',31:'GACACTTAA',32:'AGGAGGCGC',33:'GCCTGTTCA',34:'GTACATCTA',35:'AATCAGTTT',36:'ACGATGAAT',37:'TGACAGACA',38:'ATTAGGCAT',39:'GGAGTCTAA',40:'TAGAACACA',41:'AAATAAATA',42:'CCGACAAGA',43:'CACCTACCC',44:'AAGAGTAGA',45:'TCATTGAGA',46:'GACCTTAGA',47:'CAAGACCTA',48:'GGAATGATA',49:'AAACGTACC',50:'ACTATCCTC',51:'CCGTATCTA',52:'ACACATGTC',53:'TTGGTATGA',54:'GTGCAGTAA',55:'AGGATTCAA',56:'AGAATGGAG',57:'CTCTCTCAA',58:'GCTAACTCA',59:'ATCAACCGA',60:'ATGAGTTAC',61:'ACTTGATGA',62:'ACTTTAACT',63:'TTGGAGGTA',64:'GCCAATGTA',65:'ATCCAACCG',66:'GATGAACTG',67:'CCATGCACA',68:'TAGTGACTA',69:'AAACTGCGC',70:'ATTACCAAG',71:'CACTCGAGA',72:'AACTCATTG',73:'CTTGCTTCA',74:'ACCTGAGTC',75:'AGGTTCGCT',76:'AAGGACTAT',77:'CGTTCGGTA',78:'AGATAGTTC',79:'CAATTGATC',80:'GCATGGCTA',81:'ACCAGGTGT',82:'AGCTGCCGT',83:'TATAGCCCT',84:'AGAGGACCA',85:'ACAATATGG',86:'CAGCACTTC',87:'CACTTATGT',88:'AGTGAAAGG',89:'AACCCTCGG',90:'AGGCAGCTA',91:'AACCAAAGT',92:'GAGTGCGAA',93:'CGCTAAGCA',94:'AATTATAAC',95:'TACTAGTCA',96:'CAACAACGG'}
bc3 = {1:'AAGCCTTCT',2:'ATCATTCTG',3:'CACAAGTAT',4:'ACACCTTAG',5:'GAACGACAA',6:'AGTCTGTAC',7:'AAATTACAG',8:'GGCTACAGA',9:'AATGTATCG',10:'CAAGTAGAA',11:'GATCTCTTA',12:'AACAACGCG',13:'GGTGAGTTA',14:'CAGGGAGGG',15:'TCCGTCTTA',16:'TGCATAGTA',17:'ACTTACGAT',18:'TGTATGCGA',19:'GCTCCTTGA',20:'GGCACAACA',21:'CTCAAGACA',22:'ACGCTGTTG',23:'ATATTGTAA',24:'AAGTTTACG',25:'CAGCCTGGC',26:'CTATTAGCC',27:'CAAACGTGG',28:'AAAGTCATT',29:'GTCTTGGCA',30:'GATCAGCGA',31:'ACATTCGGC',32:'AGTAATTAG',33:'TGAAGCCAA',34:'TCTACGACA',35:'CATAACGTT',36:'ATGGGACTC',37:'GATAGAGGA',38:'CTACATGCG',39:'CAACGATCT',40:'GTTAGCCTA',41:'AGTTGCATC',42:'AAGGGAACT',43:'ACTACATAT',44:'CTAAGCTTC',45:'ACGAACCAG',46:'TACTTCGGA',47:'AACATCCAT',48:'AGCCTGGTT',49:'CAAGTTTCC',50:'CAGGCATTT',51:'ACGTGGGAG',52:'TCTCACGGA',53:'GCAACATTA',54:'ATGGTCCGT',55:'CTATCATGA',56:'CAATACAAG',57:'AAAGAGGCC',58:'GTAGAAGCA',59:'GCTATGGAA',60:'ACTCCAGGG',61:'ACAAGTGCA',62:'GATGGTCCA',63:'TCCTCAATA',64:'AATAAACAA',65:'CTGTACGGA',66:'CTAGATAGA',67:'AGCTATGTG',68:'AAATGGAGG',69:'AGCCGCAAG',70:'ACAGTAAAC',71:'AACGTGTGA',72:'ACTGAATTC',73:'AAGGGTCAG',74:'TGTCTATCA',75:'TCAGATTCA',76:'CACGATCCG',77:'AACAGAAAC',78:'CATGAATGA',79:'CGTACTACG',80:'TTCAGCTCA',81:'AAGGCCGCA',82:'GGTTGGACA',83:'CGTCTAGGT',84:'AATTCGGCG',85:'CAACCTCCA',86:'CAATAGGGT',87:'ACAGGCTCC',88:'ACAACTAGT',89:'AGTTGTTCT',90:'AATTACCGG',91:'ACAAACTTT',92:'TCTCGGTTA',93:'ACTAGACCG',94:'ACTCATACG',95:'ATCGAGTCT',96:'CATAGGTCA'}
bc1_seq = [bc1[i] for i in convert[:,0]]
bc2_seq = [bc2[i] for i in convert[:,1]]
bc3_seq = [bc3[i] for i in convert[:,2]]
bcseq=[]
for i in range(len(bc1_seq)):
    bcseq.append("-".join([bc1_seq[i],bc2_seq[i],bc3_seq[i]]))

with open('truecell.txt', 'w') as f:
    for item in bcseq:
        f.write("%s\n" % item)
